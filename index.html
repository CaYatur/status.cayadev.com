<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>cayadev.com — Uptime</title>
  <link rel="icon" type="image/png" href="assets/CaYaDevSite.png">

  <style>
    :root{
      --bg-1:#061124; --bg-2:#081827; --card:#0b1220; --muted:#9ca3af;
      --ok:#16a34a; --bad:#ef4444; --accent:#38bdf8; --glass: rgba(255,255,255,0.03);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color-scheme: dark;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background: linear-gradient(180deg,var(--bg-1),var(--bg-2)); color:#e6eef8;}
    .container{max-width:1100px;margin:30px auto;padding:18px}
    .shell{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
      border-radius:14px; overflow:hidden; box-shadow: 0 12px 50px rgba(2,6,23,.6);
      border:1px solid rgba(255,255,255,0.03);
    }

    /* Top bar with big logo on left */
    .top {
      display:flex; gap:18px; align-items:center; padding:18px 22px; background: linear-gradient(90deg, rgba(255,255,255,0.01), transparent);
    }
    .brand {
      display:flex; gap:14px; align-items:center; min-width:320px;
    }
    .logo-wrap{
      width:92px; height:92px; border-radius:14px; overflow:hidden; flex:0 0 92px;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      display:flex; align-items:center; justify-content:center; box-shadow: 0 8px 24px rgba(2,6,23,.45);
    }
    .logo-wrap img{width:86px;height:86px;object-fit:contain; display:block}
    .brand h1{font-size:20px;margin:0;color:#fff;letter-spacing:0.2px}
    .brand p{margin:2px 0 0 0;color:var(--muted);font-size:13px}

    /* Big status pill */
    .status-pill{
      margin-left:auto;
      display:flex; align-items:center; gap:14px; padding:12px 18px; border-radius:999px;
      background: rgba(255,255,255,0.02); min-width:240px; justify-content:center;
    }
    .status-pill.ok{ background: linear-gradient(90deg, rgba(22,163,74,0.95), rgba(16,148,71,0.95)); color:#fff; }
    .status-pill.bad{ background: linear-gradient(90deg, rgba(239,68,68,0.95), rgba(220,38,38,0.95)); color:#fff; }
    .status-pill .dot{width:14px;height:14px;border-radius:50%}
    .status-pill .dot.ok{background:#fff;box-shadow:0 6px 18px rgba(0,0,0,.25)}
    .status-pill .text{font-weight:700;font-size:18px}

    /* Main content layout */
    .main{display:grid; grid-template-columns: 1fr 340px; gap:18px; padding:20px}
    @media (max-width:960px){ .main{grid-template-columns:1fr} .brand{min-width:unset} .status-pill{margin-left:0} .logo-wrap{width:76px;height:76px} }

    /* Left: overview and history */
    .card{
      background:var(--card); padding:16px; border-radius:12px; border:1px solid var(--glass);
    }
    .overview{
      display:flex; gap:12px; align-items:center;
    }
    .big-dot{width:20px;height:20px;border-radius:50%;background:var(--muted)}
    .big-dot.up{background:var(--ok);box-shadow:0 8px 28px rgba(22,163,74,.12)}
    .big-dot.down{background:var(--bad);box-shadow:0 8px 28px rgba(239,68,68,.12)}
    .status-text{font-weight:700;font-size:16px}
    .meta{color:var(--muted);font-size:13px;margin-top:6px}

    .stats-grid{display:flex; gap:10px; margin-top:14px; flex-wrap:wrap}
    .stat{
      flex:1 1 160px; background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent); padding:12px; border-radius:10px;
      min-width:140px; border:1px solid rgba(255,255,255,0.02);
    }
    .stat .label{color:var(--muted); font-size:12px}
    .stat .value{font-weight:700; font-size:18px; margin-top:6px}

    .history{margin-top:12px; max-height:420px; overflow:auto; padding:8px; border-radius:8px; background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent)}
    .history .row{display:flex; justify-content:space-between; padding:10px; border-radius:8px}
    .history .row:nth-child(odd){background:rgba(255,255,255,0.01)}
    .reverted{opacity:.6; font-style:italic; color:var(--muted)}

    /* Right: details & controls (minimal) */
    .side {
      display:flex; flex-direction:column; gap:12px;
    }
    .hint{color:var(--muted); font-size:13px}
    .small-card{padding:12px; border-radius:10px; background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent); border:1px solid rgba(255,255,255,0.02)}
    .btn{display:inline-block;padding:8px 12px;border-radius:8px;background:var(--accent);color:#022; font-weight:700;text-decoration:none}
    footer{padding:14px 18px;color:var(--muted);font-size:13px;text-align:center}
  </style>
</head>
<body>
  <div class="container">
    <div class="shell" role="main" aria-live="polite">
      <div class="top" aria-hidden="false">
        <div class="brand" role="banner">
          <div class="logo-wrap" aria-hidden="false">
            <img src="assets/CaYaDev.png" alt="CaYaDev logo" onerror="this.style.display='none'">
          </div>
          <div>
            <h1>cayadev.com</h1>
            <p>Canlı erişilebilirlik durumu — otomatik kontroller</p>
          </div>
        </div>

        <div id="statusPill" class="status-pill" aria-live="polite">
          <div class="dot" id="pillDot" aria-hidden="true"></div>
          <div>
            <div class="text" id="pillText">Henüz kontrol edilmedi</div>
            <div style="font-size:12px;color:rgba(255,255,255,.85)" id="pillSub"></div>
          </div>
        </div>
      </div>

      <div class="main">
        <div>
          <div class="card">
            <div class="overview">
              <div id="bigDot" class="big-dot" aria-hidden="true"></div>
              <div>
                <div id="stateText" class="status-text">Henüz kontrol edilmedi</div>
                <div id="lastChecked" class="meta"></div>
              </div>
            </div>

            <div class="stats-grid" role="region" aria-label="İstatistikler">
              <div class="stat">
                <div class="label">Toplam Kontrol</div>
                <div class="value" id="total">0</div>
              </div>
              <div class="stat">
                <div class="label">Çalışma Oranı</div>
                <div class="value" id="uptime">—</div>
              </div>
              <div class="stat">
                <div class="label">En Son Durum</div>
                <div class="value" id="lastStatus">—</div>
              </div>
              <div class="stat">
                <div class="label">Kayıt</div>
                <div class="value" id="saved">0</div>
              </div>
            </div>

            <div class="history" id="historyBox" aria-label="Kontrol geçmişi"></div>
          </div>
        </div>

        <aside class="side" aria-label="Detaylar">
          <div class="small-card">
            <div class="hint">Kontrol aralığı: sabit 60s. Proxy/URL arka planda sabitlenmiştir.</div>
          </div>

          <div class="small-card">
            <div style="font-weight:700;margin-bottom:8px">False-positive koruması</div>
            <div class="hint">Kısa süreli başarısızlıklar hızlı yeniden denemelerle doğrulanır; doğrulanan kısa hatalar "GERİ ALINDI" olarak işaretlenir ve istatistiklere dahil edilmez.</div>
          </div>

          <div class="small-card">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div class="hint">Son kontrolü yeniden başlat</div>
              <a id="btnRefresh" class="btn" href="#" role="button">Kontrol Et</a>
            </div>
          </div>
        </aside>
      </div>

      <footer>Bu sayfa yalnızca cayadev.com erişilebilirliğini gösterir. Logoyu değiştirmek için assets/CaYaDev.png dosyasını değiştirin.</footer>
    </div>
  </div>

  <script>
    (function(){
      // — Ayarlar (gizli sayılabilecek sabitler)
      const TARGET = 'https://cayadev.com';
      const PROXY_BASE = 'https://api.allorigins.win/raw?url=';
      const INTERVAL_SECONDS = 60;

      // False-positive koruması
      const QUICK_RETRIES = 2;
      const RETRY_DELAY_MS = 2500;
      const REVERT_WINDOW_MS = 5 * 60 * 1000;

      // UI
      const pill = document.getElementById('statusPill');
      const pillText = document.getElementById('pillText');
      const pillSub = document.getElementById('pillSub');
      const pillDot = document.getElementById('pillDot');
      const bigDot = document.getElementById('bigDot');
      const stateText = document.getElementById('stateText');
      const lastChecked = document.getElementById('lastChecked');
      const totalEl = document.getElementById('total');
      const uptimeEl = document.getElementById('uptime');
      const lastStatusEl = document.getElementById('lastStatus');
      const savedEl = document.getElementById('saved');
      const historyBox = document.getElementById('historyBox');
      const btnRefresh = document.getElementById('btnRefresh');

      const STORAGE_KEY = 'uptime:cayadev:design-v2';
      let history = loadHistory();
      let timer = null;

      function loadHistory(){ try{ const r = localStorage.getItem(STORAGE_KEY); return r ? JSON.parse(r) : []; }catch(e){return[]} }
      function saveHistory(){ try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(history)); }catch(e){}; savedEl.textContent = history.filter(h=>!h.reverted).length; }

      function pushRecord(ok, status){
        const rec = { t: new Date().toISOString(), ok: !!ok, status: status || null, reverted:false };
        history.unshift(rec);
        if(history.length>2000) history.length = 2000;
        saveHistory(); renderHistory();
      }

      function markRecentFailuresReverted(){
        const now = Date.now();
        for(let i=0;i<Math.min(6, history.length); i++){
          const r = history[i];
          if(!r || r.ok || r.reverted) continue;
          const t = new Date(r.t).getTime();
          if(now - t <= REVERT_WINDOW_MS) r.reverted = true;
        }
        saveHistory(); renderHistory();
      }

      function renderHistory(){
        historyBox.innerHTML = '';
        history.forEach(r=>{
          const row = document.createElement('div');
          row.className = 'row' + (r.reverted ? ' reverted' : '');
          const left = document.createElement('div');
          left.innerHTML = `<small>${new Date(r.t).toLocaleString()}</small>`;
          const right = document.createElement('div');
          if(r.reverted){
            right.innerHTML = `<span><strong>GERİ ALINDI</strong> ${r.status?('('+r.status+')'):''}</span>`;
          } else {
            right.innerHTML = r.ok ? `<span style="color:var(--ok)"><strong>AKTİF</strong> ${r.status?('('+r.status+')'):''}</span>` : `<span style="color:var(--bad)"><strong>AKTİF DEĞİL</strong> ${r.status?('('+r.status+')'):''}</span>`;
          }
          row.appendChild(left); row.appendChild(right);
          historyBox.appendChild(row);
        });

        const counted = history.filter(h=>!h.reverted);
        totalEl.textContent = counted.length;
        const ups = counted.filter(h=>h.ok).length;
        uptimeEl.textContent = counted.length ? Math.round(ups/counted.length*100) + '%' : '—';
        lastStatusEl.textContent = counted.length ? (counted[0].ok ? 'AKTİF' : 'AKTİF DEĞİL') : '—';
      }

      function setVisual(ok, status){
        if(ok){
          pill.classList.remove('bad'); pill.classList.add('ok');
          pillDot.style.background = '#fff';
          pillText.textContent = 'AKTİF';
          pillSub.textContent = status ? 'HTTP ' + status : 'Erişilebilir';
          bigDot.className = 'big-dot up';
          stateText.innerHTML = `<strong style="color:var(--ok)">AKTİF</strong> ${status?('('+status+')'):''}`;
        } else {
          pill.classList.remove('ok'); pill.classList.add('bad');
          pillDot.style.background = '#fff';
          pillText.textContent = 'AKTİF DEĞİL';
          pillSub.textContent = status ? (status === 'err' ? 'Bağlantı hatası' : 'HTTP ' + status) : 'Erişilemiyor';
          bigDot.className = 'big-dot down';
          stateText.innerHTML = `<strong style="color:var(--bad)">AKTİF DEĞİL</strong> ${status?('('+status+')'):''}`;
        }
        lastChecked.textContent = 'Son kontrol: ' + new Date().toLocaleString();
      }

      function buildUrl(){ return PROXY_BASE + encodeURIComponent(TARGET); }

      async function tryFetch(method, signal){
        try{
          const res = await fetch(buildUrl(), { method, cache:'no-store', signal });
          return { ok: res.ok, status: res.status };
        }catch(e){
          return { ok:false, status:'err' };
        }
      }

      async function checkOnce(){
        const controller = new AbortController();
        const timeout = setTimeout(()=>controller.abort(), 15000);
        try{
          let head = await tryFetch('HEAD', controller.signal);
          if(head.status !== 'err' && typeof head.status === 'number'){
            clearTimeout(timeout);
            setVisual(head.ok, head.status);
            pushRecord(head.ok, head.status);
            if(head.ok) markRecentFailuresReverted();
            return;
          }

          // hızlı yeniden denemeler
          let final = null;
          for(let i=0;i<=QUICK_RETRIES;i++){
            const method = (i===QUICK_RETRIES) ? 'GET' : 'HEAD';
            const r = await tryFetch(method, controller.signal);
            if(r.status !== 'err' || r.ok){
              final = r; break;
            }
            if(i<QUICK_RETRIES) await new Promise(r=>setTimeout(r, RETRY_DELAY_MS));
          }

          clearTimeout(timeout);

          if(final){
            setVisual(final.ok, final.status);
            pushRecord(final.ok, final.status);
            if(final.ok) markRecentFailuresReverted();
          } else {
            setVisual(false, 'err');
            pushRecord(false, 'err');
          }
        }catch(e){
          clearTimeout(timeout);
          setVisual(false, 'err');
          pushRecord(false, 'err');
        }
      }

      function start(){
        if(timer) clearInterval(timer);
        checkOnce();
        timer = setInterval(checkOnce, INTERVAL_SECONDS * 1000);
      }

      // init
      renderHistory();
      btnRefresh.addEventListener('click', (e)=>{ e.preventDefault(); checkOnce(); });
      window.addEventListener('load', start);
      document.addEventListener('visibilitychange', ()=>{
        if(document.hidden){ if(timer){ clearInterval(timer); timer = null; } }
        else start();
      });

      // console bilgi
      console.info('Sayfa: geliştirilmiş tasarım + false-positive koruması aktif.');
    })();
  </script>
</body>
</html>